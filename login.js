function passwordStrength(n,e){var t="bad",a="bad",h="rất tốt",i="rất mạnh";return score=0,""==n?null:n.length<4?t:void 0!=e&&n.toLowerCase()==e.toLowerCase()?a:(score+=4*n.length,score+=1*(checkRepetition(1,n).length-n.length),score+=1*(checkRepetition(2,n).length-n.length),score+=1*(checkRepetition(3,n).length-n.length),score+=1*(checkRepetition(4,n).length-n.length),n.match(/(.*[0-9].*[0-9].*[0-9])/)&&(score+=5),n.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(score+=5),n.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(score+=10),n.match(/([a-zA-Z])/)&&n.match(/([0-9])/)&&(score+=15),n.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&n.match(/([0-9])/)&&(score+=15),n.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&n.match(/([a-zA-Z])/)&&(score+=15),(n.match(/^\w+$/)||n.match(/^\d+$/))&&(score-=10),score<0&&(score=0),score>100&&(score=100),score<34?a:score<68?h:i)}function checkRepetition(n,e){for(res="",i=0;i<e.length;i++){for(repeated=!0,j=0;j<n&&j+i+n<e.length;j++)repeated=repeated&&e.charAt(j+i)==e.charAt(j+i+n);j<n&&(repeated=!1),repeated?(i+=n-1,repeated=!1):res+=e.charAt(i)}return res}function $regpassval(){var n=$(this).val(),e=$(this).closest(".reg-panel"),t=e.find('input[name="reg-name"]').val();"bad"==passwordStrength(n,t)?($(this).attr("data-check","true"),$node("Thông báo","Mật khẩu đăng ký của bạn quá dễ hoặc quá ngắn, xin vui lòng nhập mật khẩu khác.<br>Hãy đặt mật khẩu có độ dài hơn 10 để đăng ký.",!0)):$(this).attr("data-check","false")}function $regfast(){var n=$(this),e=n.closest(".reg-panel"),t=e.find('input[name="reg-pass"]'),a=e.find('input[name="reg-name"]').val(),h=t.val(),i=e.find('input[name="reg-mail"]').val(),o=t.attr("data-check");"true"==o?$node("Thông báo","Mật khẩu đăng ký của bạn quá dễ hoặc quá ngắn, xin vui lòng nhập mật khẩu khác.<br>Hãy đặt mật khẩu có độ dài hơn 10 để đăng ký.",!0):(0==a.length&&$node("Thông báo","Vui lòng nhập tên đăng nhập để đăng ký.",!0),0==i.length&&0==/@/.test(i)?$node("Thông báo","Vui lòng nhập đúng email.",!0):(n.hide(),$node("Thông báo","Đang xử lý vui lòng chờ.",!1,!0,!0),$.post("/register?agreed=true&step=2",{username:a,email:i,password:h,submit:"Chấp Nhận"}).done(function(e){var t=$("<div>"+e.split("<!--")[2]+"</div>"),o=t.find("#preview");if(o.length>0){n.show();var r=o.find('span[style*="red"]').text();$node("Thông báo",r,!0)}else{var s=t.find('input[name="auth[]"]:eq(0)').val(),g=t.find('input[name="confirm_pass"]').val();$.post("/register?agreed=true&step=2",{"auth[]":s,username:a,email:i,password:h,password_confirm:h,confirm_pass:g,submit:"save"}).done(function(e){var t=$("<div>"+e.split("<!--")[2]+"</div>"),i=t.find("#preview");if(i.length>0){n.show();var o=i.find('span[style*="red"]').text();$node("Thông báo",o,!0)}else $node("Thông báo","Đăng ký thành công. Đang tiến hành đăng nhập",!1,!1,!0),$.post("/login",{username:a,password:h,login:"true"}).done(function(n){if(n.indexOf("body-main")>-1){var e=n.match(/\_userdata\[\"user_id\"\]\s\=\s(\d+);/);null!=e&&($node("Thông báo","Đăng nhập thành công. Đang chuyển đến trang cá nhân của bạn.",!1,!1,!0),location.href="/u"+e[1])}})})}})))}function $loginfast(){var n=$(this).closest(".login-panel"),e=n.find('input[name="username"]').val(),t=n.find('input[name="password"]').val();0==e.length&&$node("Thông báo","Xin vui lòng nhập tên để đăng nhập.",!0),0==t.length?$node("Thông báo","Xin vui lòng nhập mật khẩu để đăng nhập.",!0):($node("Thông báo","Đang đăng nhập vui lòng chờ...",!1,!0,!0),$.post("/login",{username:e,password:t,login:"true",autologin:"on"}).done(function(n){n.indexOf("body-main")>-1?($node("Thông báo","Đăng nhập thành công. Đang tải lại trang.",!1,!0,!0),location.reload()):$node("Thông báo","Đăng nhập không thành công, vui lòng kiểm tra lại tên tài khoản và mật khẩu.",!0)}))}
